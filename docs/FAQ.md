# 常见问题解答 (FAQ)

## 安装和设置

### Q: 如何安装依赖?

**GUI 版本**:
```bash
# Mac/Linux
./install_gui.sh

# Windows
双击运行 install_gui.bat
```

**命令行版本**:
```bash
python3 -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install opencv-python numpy
```

### Q: 安装失败怎么办?

1. 确保已安装 Python 3.7+
2. 检查网络连接
3. 尝试使用国内镜像:
```bash
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple opencv-python numpy
```

### Q: Mac 上提示"无法打开应用"?

如果打包后的应用被 macOS 阻止:
```bash
xattr -cr dist/LomoKinoGUI.app
```

---

## 使用问题

### Q: 如何添加胶片图片?

**方法 1**: 拖拽文件到窗口
**方法 2**: 点击"添加胶片"按钮选择文件
**方法 3**: 命令行指定文件路径

### Q: 支持哪些图片格式?

- JPG / JPEG
- PNG
- 其他 OpenCV 支持的格式

### Q: 如何批量处理多张胶片?

**GUI 版本**:
1. 添加多张胶片图片
2. 点击"提取所有帧"一次性处理

**命令行版本**:
```bash
python lomokino_processor.py *.jpg
# 或指定多个文件
python lomokino_processor.py film1.jpg film2.jpg film3.jpg
```

---

## 帧检测问题

### Q: 检测的帧数不对怎么办?

**帧数过多 (over-detection)**:

1. **降低检测灵敏度**:
   - GUI: 选择"低 (保守)"
   - 命令行: `--detection-sensitivity low`

2. **增加最小帧间距**:
   - GUI: 设置为 80-100 像素
   - 命令行: `--min-frame-distance 80`

**帧数过少 (under-detection)**:

1. **提高检测灵敏度**:
   - GUI: 选择"高 (激进)"
   - 命令行: `--detection-sensitivity high`

2. **减小最小帧间距**:
   - GUI: 设置为 40-60 像素
   - 命令行: `--min-frame-distance 40`

**使用手动选择框 (最准确)**:
1. 切换到手动选择框模式
2. 添加并调整选择框到每一帧
3. 点击"✂️ 提取"

### Q: 自动检测适合什么情况?

适合:
- 标准 LomoKino 胶片
- 分隔线清晰可见
- 图片质量良好
- 帧数在 4-12 之间

不适合:
- 分隔线模糊或不清晰
- 特殊格式胶片
- 只有 2-3 帧
- 帧高度变化很大

这些情况建议使用 **手动选择框模式**。

### Q: 什么是检测灵敏度?

- **低 (保守)**: 只检测最明显的分隔线,适合质量差的图片
- **中 (推荐)**: 平衡的检测,适合大多数情况
- **高 (激进)**: 最敏感,检测更多分隔线,适合高质量图片
- **自动**: 根据图片尺寸智能选择

### Q: 什么是最小帧间距?

相邻帧之间的最小距离 (像素)。作用:
- 过滤掉过于接近的误检测
- 防止同一帧内的特征被误识别为分隔线
- 避免检测到过小的区域

推荐值:
- 小图片 (800px 高): 60-80px
- 中图片 (1200px 高): 80-120px
- 大图片 (1500px+ 高): 120-150px

---

## 帧提取问题

### Q: 提取的帧画面不完整?

v2.0 已修复此问题:
- 宽度保留率从 64% 提升到 82%+
- 更保守的内容边界检测
- 防止过度裁切保护

如果仍有问题:
1. 使用手动选择框模式
2. 精确控制提取区域

### Q: 提取的帧有黑边怎么办?

这是正常的:
- 自动裁切会去除大部分黑边
- 保留少量黑边确保画面完整
- 可以使用手动选择框精确控制

### Q: 如何删除不需要的帧?

**GUI 版本**:
- 点击帧右上角的红色 × 按钮
- 确认删除

**命令行版本**:
- 进入 `output/film_frames/` 目录
- 手动删除不需要的帧图片

### Q: 提取失败怎么办?

检查:
1. 图片文件是否损坏
2. 图片格式是否支持
3. 是否有足够的磁盘空间
4. 查看错误提示信息

---

## 手动选择框

### Q: 什么时候使用手动选择框?

推荐使用场景:
- 自动检测结果不满意
- 特殊格式的胶片
- 需要 100% 精确控制
- 帧数很少 (2-3 帧)
- 帧高度不一致

### Q: 如何调整选择框大小?

1. **鼠标移到边缘**:
   - 上/下边: 光标变成 ↕️,可调高度
   - 左/右边: 光标变成 ↔️,可调宽度
   - 四个角: 光标变成 ↗️↖️↙️↘️,可对角调整

2. **拖动边缘**: 实时调整大小

3. **拖动内部**: 移动整个选择框

### Q: 如何快速创建多个相同大小的选择框?

1. 创建第一个选择框
2. 调整到合适的大小
3. 选中这个框
4. 点击 📋 复制按钮
5. 重复复制,得到多个相同大小的框
6. 分别拖动到对应位置

### Q: 选择框提取位置不准确?

v3.1 已完全修复:
- 坐标系统重构
- 提取位置 100% 准确匹配选择框
- 如仍有问题,请检查是否是最新版本

### Q: 追加模式是什么?

提取时不清空已有帧,而是追加到帧列表:
1. 处理第一张胶片,提取 8 帧
2. 处理第二张胶片,追加 6 帧
3. 总共 14 帧,可生成完整视频

---

## 视频生成

### Q: 视频生成失败?

检查:
1. 是否至少提取了 1 帧
2. 输出目录是否有写入权限
3. 磁盘空间是否足够
4. 是否安装了 opencv-python

### Q: 生成的视频画面变形?

v2.0 已修复:
- 使用保持宽高比的缩放算法
- 中位数尺寸作为目标
- 黑边居中显示
- 高质量插值 (LANCZOS4)

### Q: 如何设置视频帧率?

**GUI 版本**:
- 调整右侧 "FPS" 数值

**命令行版本**:
```bash
python lomokino_processor.py --fps 24 film.jpg
```

推荐值:
- 8-12 FPS: 胶片风格
- 24-30 FPS: 流畅播放
- 1-5 FPS: 幻灯片效果

### Q: 视频文件很大怎么办?

1. 使用较低的 FPS
2. 减小源图片分辨率
3. 使用第三方工具压缩:
```bash
ffmpeg -i input.mp4 -crf 23 output.mp4
```

---

## 界面和操作

### Q: 如何放大查看帧?

v3.2 新增大图查看器:
1. 双击任意帧
2. 弹出全屏查看窗口
3. 使用左右箭头切换帧
4. 按 ESC 或点击关闭

### Q: 如何清空所有帧?

点击 "🧹 清空所有帧" 按钮 (v3.2+)

或手动删除每一帧

### Q: 胶片预览区域太小?

v3.1 已优化:
- 控制区域减少 60%
- 预览区域增加 45%
- 限制控制区最大高度 120px

### Q: 按钮显示英文怎么办?

v2.0 已修复,确认对话框使用中文按钮。
如仍有问题,请更新到最新版本。

---

## 性能和优化

### Q: 处理速度慢怎么办?

1. **使用命令行版本** - 比 GUI 快
2. **减小图片尺寸** - 处理前缩小图片
3. **关闭不需要的程序** - 释放内存
4. **使用 SSD** - 更快的读写速度

### Q: 内存占用大怎么办?

1. 一次处理较少的胶片
2. 处理完一批后生成视频
3. 清空帧列表再处理下一批

### Q: 可以在服务器上使用吗?

可以,使用命令行版本:
```bash
# 无显示环境
python lomokino_processor.py --output-dir output *.jpg
```

---

## 高级使用

### Q: 如何保存参数设置?

当前版本不支持保存预设。
建议:
1. 记录最佳参数组合
2. 创建脚本使用固定参数

未来版本计划添加此功能。

### Q: 可以自定义裁切范围吗?

使用手动选择框模式:
1. 精确控制每一帧的提取区域
2. 可以只提取画面的一部分
3. 支持不规则裁切

### Q: 如何处理连续拍摄的多张胶片?

1. **GUI 版本**:
   - 添加所有胶片
   - 提取所有帧 (追加模式)
   - 生成一个长视频

2. **命令行版本**:
   ```bash
   python lomokino_processor.py film*.jpg
   ```

### Q: 可以导出为其他格式吗?

当前只支持 MP4 视频和 JPG 帧图片。

导出帧图片后可以:
1. 使用其他工具合成 GIF
2. 生成 PNG 序列
3. 导入其他视频编辑软件

---

## 错误和调试

### Q: 报错 "No module named 'cv2'"?

安装 OpenCV:
```bash
pip install opencv-python
```

### Q: 报错 "No module named 'PyQt6'"?

安装 PyQt6 (仅 GUI 版本需要):
```bash
pip install PyQt6
```

### Q: 启动时崩溃?

1. 检查 Python 版本 (需要 3.7+)
2. 重新安装依赖
3. 查看错误日志
4. 尝试命令行版本

### Q: 如何报告 bug?

1. 记录操作步骤
2. 保存错误信息
3. 准备示例图片 (如可能)
4. 提交 Issue

---

## 其他问题

### Q: 支持其他类型的胶片吗?

理论上支持所有竖向排列的胶片:
- LomoKino
- 其他类似格式的胶片

关键要求:
- 画面帧纵向排列
- 有明显的分隔线 (或使用手动选择框)

### Q: 可以处理横向胶片吗?

当前版本专为纵向胶片设计。
横向胶片可能需要:
1. 先旋转图片 90 度
2. 使用手动选择框模式

### Q: 项目是开源的吗?

是的,采用 MIT 许可证。

### Q: 如何贡献代码?

欢迎提交 Issue 和 Pull Request!

---

## 相关资源

- **快速开始**: [QUICKSTART.md](../QUICKSTART.md)
- **版本更新**: [CHANGELOG.md](CHANGELOG.md)
- **详细文档**: [docs/](.)

---

**没找到答案?** 欢迎提交 Issue 或查看详细文档!
